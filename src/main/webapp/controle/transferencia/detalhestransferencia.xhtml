<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">


	
	<div class="ui-fluid">

		<p:panelGrid id="panelTable" columns="1"
			columnClasses="ui-grid-col-12" layout="grid"
			styleClass="ui-panelgrid-blank">
			<p:dataTable id="tablePecas" rowIndexVar="linha"
				value="#{controladorTransferencia.transferencia.transferenciaDetalhes}"
				var="det" emptyMessage="Nenhum Registro Encontrado." rows="10"
				paginator="true" paginatorAlwaysVisible="false"
				paginatorPosition="bottom">
				<f:facet name="header">
							Itens da Transferência
			    </f:facet>

				<p:column headerText="ID" style="width: 5%;">
					<h:outputLabel value="#{det.id}" />
				</p:column>

				<p:column headerText="Item" style="width: 5%;">
					<h:outputLabel value="#{det.pecaTranferencia.id}" />
				</p:column>

				<p:column headerText="Peça" style="width: 25%;">
					<h:outputLabel value="#{det.pecaTranferencia.descricao}" />
				</p:column>

				<p:column headerText="Nº Série" style="width: 14%;">
					<h:outputLabel value="#{det.pecaTranferencia.numeroSerie}" />
				</p:column>

				<p:column headerText="Setor de Saída" style="width: 14%;">
					<h:outputLabel value="#{det.pecaTranferencia.setor.descricao}" />
				</p:column>

				<p:column id="qtdTrans" headerText="QTD" style="width: 8%;">
					<p:inputMask id="qtd" label="Quantidade" value="#{det.quantidade}" mask="9?99"
						readonly="#{controladorTransferencia.temTransferenciaSalva}">
						<p:ajax partialSubmit="true" process="@this"
							update="@this frm:panelMain frm:tablePecas frm:msg"
							listener="#{controladorTransferencia.calculaQuantidades(linha)}" />
					</p:inputMask>
				</p:column>
				<p:column headerText="QTD Atual" style="width: 8%;">
					<h:outputLabel value="#{det.quantidadeAtualDia}" />
				</p:column>
				
				<p:column id="est" headerText="Estoque" style="width: 8%;">
					<h:outputLabel value="#{det.totalQuantidade}" />
				</p:column>

				<p:column headerText="Ações" style="width: 10%;">
					<p:panelGrid id="panelBotoes" columns="3"
						columnClasses="ui-grid-col-3" layout="grid"
						styleClass="ui-panelgrid-blank">


						<p:commandButton id="btExcluir" icon="fa fa-trash-o"
							title="Excluir Item"
							actionListener="#{controladorTransferencia.acaoRemoverItem(linha)}"
							disabled="#{not controladorTransferencia.naoEstaVaiza}"
							update="frm:panelTable frm:panelMain frm:btnSalvar" process="@this"
							style="width: 30px;margin-left: 20px;">
							<p:confirm header="Confirmação"
								message="Excluir Item Selecionado ?" icon="ui-icon-alert" />
						</p:commandButton>

					</p:panelGrid>
					<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
						<p:commandButton value="Sim" type="button" process="@this"
							styleClass="ui-confirmdialog-yes" icon="ui-icon-check">
						</p:commandButton>
						<p:commandButton value="Não" type="button"
							styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
					</p:confirmDialog>

				</p:column>
			</p:dataTable>
		</p:panelGrid>
	</div>

	<script type="text/javascript">
	function refresh() {

	    setTimeout(function () {
	        location.reload()
	    }, 100);
	}

	</script>
</ui:composition>